# Chuỗi Json
## 1. Khái niệm
+ Chuỗi Json là một dữ liệu văn bản được định dạng dùng để truyền tải dữ liệu, Chuỗi Json được thiết kế thân để dễ đọc và dễ viết cho con người, cũng như dễ dàng để phân tích và tạo ra cho máy tính. 
+ Chuỗi Json sử dụng cấu trúc gồm các __object__, mỗi object gồm một tập hợp các cặp __key - value__ đặt trong dấu ngoặc { } và ngăn cách cái thành phần bằng dấu ",". Ví dụ về một object: 
```bash
{ 
  "name": "Phan Tinh",
  "age": 22,
  "grades": [85, 90, 78]
}"
```
-> Chúng ta thấy object "grades": [85, 90, 78], có key=grade và value là kiểu dữ liệu Array. 
+ Ví dụ về một chuỗi Json gồm nhiều objects:
```bash
[
  {
    "name": "John Doe",
    "age": 30,
    "city": "New York",
    "occupation": "Software Engineer",
    "isStudent": false
  },
  {
    "name": "Jane Smith",
    "age": null,
    "city": "Los Angeles",
    "contact": {
      "email": "jane.smith@example.com",
      "phone": "555-1234"
    }
  },
  {
    "name": "Bob Johnson",
    "age": 35,
    "city": "Chicago"
  }
]

```
## 2. Tạo kiểu dữ liệu Json
+ Trước tiên cần khởi tạo kiểu dữ liệu JsonType để lưu trữ các kiểu dữ liệu có thể có.
```bash
  typedef enum {
    JSON_NULL,
    JSON_BOOLEAN,
    JSON_NUMBER,
    JSON_STRING,
    JSON_ARRAY,
    JSON_OBJECT
} JsonType;
```
+ Chuỗi Json sẽ gồm key - value, tiếp theo tạo kiểu dữ liệu cho "value". JsonValue sẽ là một cấu trúc gồm 2 thành phần:  type (kiểu JsonType) và value (kiểu union). Sử dụng Union vì ứng với một thành phần của value chỉ có một JsonType.
```bash
typedef struct JsonValue
{
    JsonType type;
    union
    {
        int boolean;   // true or false
        double number; // giá trị số thực
        char *string;  // chuỗi
        struct
        {
            struct JsonValue *values; // đệ quy để xác định đặc điểm từng phần tử
            size_t count;             // số lượng phần tử
        } array;
        struct
        {
            char **keys;              // mảng lưu trữ chuỗi key ["key1", "key2", "key3"]
            struct JsonValue *values; // đệ quy để xác định đặc điểm từng value
            size_t count;             // số lượng cặp key - value
        } object;
    } value;
} JsonValue;

```
## 3. Gán giá trị thủ công cho chuỗi Json
+ VÍ dụ muốn xây dựng một dũ liệu Json như sau:
```bash
{
  "name": "John Doe",
  "age": 30.1234,
  "isStudent": true,
  "grades": [85, 90, 78]
}
```
-> Các bước gán thủ công: 
```bash
int main ()
{
  JsonValue *json_str = (JsonValue *)malloc(sizeof(JsonValue)); // cấp phát bộ nhớ động
  json_str->type = JSON_OBJECT; //một object của chuỗi json
  json_str->value.object.count = 4; //số cặp key-value có trong object

  // cấp phát bộ nhớ lưu trữ các cặp keys và values
  json_str->value.object.keys = (char **)malloc(json_str->value.object.count * sizeof(char *)); 
  json_str->value.object.values = (JsonValue *)malloc(json_str->value.object.count * sizeof(JsonValue));

  // tạo cặp key-value 1
  json_str->value.object.keys[0] = "name";
  json_str->value.object.values[0].type = JSON_STRING;
  json_str->value.object.values[0].value.string = "John Doe";
  return 0;

  // tạo cặp key-value 2
  json_str->value.object.keys[1] = "age";
  json_str->value.object.values[1].type = JSON_NUMBER;
  json_str->value.object.values[1].value.number = 30.1234;

  // tạo cặp key-value 3
  json_str->value.object.keys[2] = "isStudent";
  json_str->value.object.values[2].type = JSON_BOOLEAN;
  json_str->value.object.values[2].value.boolean = true;
    
  // tạo cặp key-value 4
  json_str->value.object.keys[3] = "grades";
  json_str->value.object.values[3].type = JSON_ARRAY;
  json_str->value.object.values[3].value.array.count = 3;

  // cấp phát vùng nhớ để lưu trữ mảng
  json_str->value.object.values[3].value.array.values = (JsonValue *)malloc(json_str->value.object.values[4].value.array.count * sizeof(JsonValue));

  // các phần tử có trong mảng vừa cấp phát
  json_str->value.object.values[3].value.array.values[0].value.number = 85;
  json_str->value.object.values[3].value.array.values[1].value.number = 90;
  json_str->value.object.values[3].value.array.values[2].value.number = 78;
}
```
## 4. Các hàm phân tích chuỗi Json
